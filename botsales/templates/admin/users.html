{% extends "base.html" %}

{% block title %}Manage Users | Admin | BotSales{% endblock %}

{% block extra_css %}
<style>
    .admin-page { padding: 2rem 0; }
    .admin-nav {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 2rem;
        background: var(--white);
        padding: 0.5rem;
        border-radius: var(--radius-lg);
    }
    .admin-nav a {
        padding: 0.75rem 1.5rem;
        border-radius: var(--radius);
        color: var(--gray-600);
        font-weight: 500;
    }
    .admin-nav a:hover { background: var(--gray-100); color: var(--gray-900); }
    .admin-nav a.active { background: var(--primary); color: var(--white); }

    .data-table {
        width: 100%;
        background: var(--white);
        border-radius: var(--radius-lg);
        overflow: hidden;
    }
    .data-table th, .data-table td {
        padding: 1rem;
        text-align: left;
        border-bottom: 1px solid var(--gray-100);
    }
    .data-table th {
        background: var(--gray-50);
        font-weight: 600;
        font-size: 0.8125rem;
        color: var(--gray-600);
        text-transform: uppercase;
    }
    .data-table tr:hover { background: var(--gray-50); }
    .user-cell {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }
    .user-avatar {
        width: 2.25rem;
        height: 2.25rem;
        border-radius: var(--radius-full);
        background: var(--primary-light);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--primary);
        font-weight: 600;
    }
    .badge { padding: 0.25rem 0.5rem; border-radius: var(--radius); font-size: 0.75rem; font-weight: 600; }
    .badge-admin { background: var(--primary-light); color: var(--primary); }
    .badge-verified { background: #D1FAE5; color: #059669; }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="admin-page">
        <h1 class="mb-4">Manage Users</h1>

        <nav class="admin-nav">
            <a href="{{ url_for('admin_dashboard') }}">Overview</a>
            <a href="{{ url_for('admin_users') }}" class="active">Users</a>
            <a href="{{ url_for('admin_listings') }}">Listings</a>
            <a href="{{ url_for('admin_reports') }}">Reports</a>
            <a href="{{ url_for('admin_articles') }}">Articles</a>
        </nav>

        <table class="data-table">
            <thead>
                <tr>
                    <th>User</th>
                    <th>Email</th>
                    <th>Type</th>
                    <th>Listings</th>
                    <th>Joined</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users.items %}
                <tr>
                    <td>
                        <div class="user-cell">
                            <div class="user-avatar">{{ user.username[0].upper() }}</div>
                            <div>
                                <div style="font-weight: 500;">{{ user.username }}</div>
                                {% if user.is_admin %}<span class="badge badge-admin">Admin</span>{% endif %}
                                {% if user.is_verified %}<span class="badge badge-verified">Verified</span>{% endif %}
                            </div>
                        </div>
                    </td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.seller_type|title }}</td>
                    <td>{{ user.listings.count() }}</td>
                    <td>{{ user.created_at.strftime('%d %b %Y') }}</td>
                    <td>
                        {% if user.is_active %}
                            <span class="text-success"><i class="fas fa-check-circle"></i> Active</span>
                        {% else %}
                            <span class="text-danger"><i class="fas fa-times-circle"></i> Inactive</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if users.pages > 1 %}
        <div class="pagination mt-4">
            {% for page_num in users.iter_pages() %}
                {% if page_num %}
                    <a href="{{ url_for('admin_users', page=page_num) }}" class="{{ 'active' if page_num == users.page }}">{{ page_num }}</a>
                {% else %}
                    <span>...</span>
                {% endif %}
            {% endfor %}
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
