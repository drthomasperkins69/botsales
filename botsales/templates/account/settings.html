{% extends "base.html" %}

{% block title %}Account Settings | BotSales{% endblock %}

{% block extra_css %}
<style>
    .settings-page {
        padding: 2rem 0;
        max-width: 800px;
        margin: 0 auto;
    }

    .settings-nav {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 2rem;
        border-bottom: 1px solid var(--gray-200);
        padding-bottom: 1rem;
    }

    .settings-nav a {
        padding: 0.5rem 1rem;
        border-radius: var(--radius);
        color: var(--gray-600);
        font-weight: 500;
    }

    .settings-nav a:hover {
        background: var(--gray-100);
        color: var(--gray-900);
    }

    .settings-nav a.active {
        background: var(--primary-light);
        color: var(--primary);
    }

    .settings-section {
        background: var(--white);
        border-radius: var(--radius-lg);
        padding: 2rem;
        margin-bottom: 1.5rem;
    }

    .section-title {
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: 1.5rem;
        padding-bottom: 0.75rem;
        border-bottom: 1px solid var(--gray-200);
    }

    .avatar-upload {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .current-avatar {
        width: 6rem;
        height: 6rem;
        border-radius: var(--radius-full);
        background: var(--primary-light);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        color: var(--primary);
        font-weight: 700;
        overflow: hidden;
    }

    .current-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .avatar-actions {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .form-row {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
    }

    @media (max-width: 768px) {
        .form-row {
            grid-template-columns: 1fr;
        }

        .settings-nav {
            overflow-x: auto;
            flex-wrap: nowrap;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="settings-page">
        <h1 class="mb-4">Account Settings</h1>

        <nav class="settings-nav">
            <a href="{{ url_for('account_settings') }}" class="active">Profile</a>
            <a href="{{ url_for('notification_settings') }}">Notifications</a>
            <a href="{{ url_for('change_password') }}">Security</a>
        </nav>

        <form action="{{ url_for('account_settings') }}" method="POST" enctype="multipart/form-data">
            <div class="settings-section">
                <h3 class="section-title">Profile Photo</h3>
                <div class="avatar-upload">
                    <div class="current-avatar">
                        {% if current_user.avatar %}
                            <img src="{{ url_for('uploaded_file', filename=current_user.avatar) }}" alt="">
                        {% else %}
                            {{ current_user.username[0].upper() }}
                        {% endif %}
                    </div>
                    <div class="avatar-actions">
                        <input type="file" name="avatar" id="avatarInput" accept="image/*" style="display: none;">
                        <button type="button" class="btn btn-secondary" onclick="document.getElementById('avatarInput').click()">
                            <i class="fas fa-camera"></i> Upload Photo
                        </button>
                        <span class="form-hint">JPG, PNG or GIF. Max 5MB.</span>
                    </div>
                </div>
            </div>

            <div class="settings-section">
                <h3 class="section-title">Personal Information</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">First Name</label>
                        <input type="text" name="first_name" class="form-control" value="{{ current_user.first_name or '' }}">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Last Name</label>
                        <input type="text" name="last_name" class="form-control" value="{{ current_user.last_name or '' }}">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <input type="email" class="form-control" value="{{ current_user.email }}" disabled>
                    <span class="form-hint">Contact support to change your email address.</span>
                </div>

                <div class="form-group">
                    <label class="form-label">Phone Number</label>
                    <input type="tel" name="phone" class="form-control" value="{{ current_user.phone or '' }}" placeholder="e.g., 0412 345 678">
                </div>

                <div class="form-group">
                    <label class="form-label">Bio</label>
                    <textarea name="bio" class="form-control" rows="3" placeholder="Tell buyers a bit about yourself...">{{ current_user.bio or '' }}</textarea>
                </div>
            </div>

            <div class="settings-section">
                <h3 class="section-title">Location</h3>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Suburb/City</label>
                        <input type="text" name="location" class="form-control" value="{{ current_user.location or '' }}" placeholder="e.g., Sydney">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Postcode</label>
                        <input type="text" name="postcode" class="form-control" value="{{ current_user.postcode or '' }}" placeholder="e.g., 2000" maxlength="4">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">State</label>
                    <select name="state" class="form-control">
                        <option value="">Select state...</option>
                        <option value="NSW" {{ 'selected' if current_user.state == 'NSW' }}>New South Wales</option>
                        <option value="VIC" {{ 'selected' if current_user.state == 'VIC' }}>Victoria</option>
                        <option value="QLD" {{ 'selected' if current_user.state == 'QLD' }}>Queensland</option>
                        <option value="WA" {{ 'selected' if current_user.state == 'WA' }}>Western Australia</option>
                        <option value="SA" {{ 'selected' if current_user.state == 'SA' }}>South Australia</option>
                        <option value="TAS" {{ 'selected' if current_user.state == 'TAS' }}>Tasmania</option>
                        <option value="ACT" {{ 'selected' if current_user.state == 'ACT' }}>ACT</option>
                        <option value="NT" {{ 'selected' if current_user.state == 'NT' }}>Northern Territory</option>
                    </select>
                </div>
            </div>

            <div class="settings-section">
                <h3 class="section-title">Seller Settings</h3>

                <div class="form-group">
                    <label class="form-label">Seller Type</label>
                    <select name="seller_type" class="form-control">
                        <option value="private" {{ 'selected' if current_user.seller_type == 'private' }}>Private Seller</option>
                        <option value="dealer" {{ 'selected' if current_user.seller_type == 'dealer' }}>Dealer</option>
                        <option value="manufacturer" {{ 'selected' if current_user.seller_type == 'manufacturer' }}>Manufacturer</option>
                    </select>
                    <span class="form-hint">Dealers and manufacturers may be eligible for verification.</span>
                </div>
            </div>

            <div class="d-flex justify-between">
                <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Cancel</a>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
